USE NBNREPORTING
GO

SELECT 
  OCCURRENCE_KEY,
  SAMPLE_KEY,
  CASE WHEN [TAXON COMMON NAME] = [TAXON LATIN NAME] THEN
    'A ' + [TAXON GROUP]
  ELSE
    [TAXON COMMON NAME]
  END AS [COMMON NAME],
  [TAXON LATIN NAME],
  [TAXON GROUP],
  REPLACE([SAMPLE_SPATIAL_REF], ' ', '') AS GRID_REF,
  CASE WHEN [SAMPLE LOCATION NAME] IS NOT NULL THEN
    CASE WHEN [SAMPLE LOCATION NAME] != [SAMPLE LOCATION] THEN
      [SAMPLE LOCATION NAME] + ', ' + [SAMPLE LOCATION]
    ELSE
      [SAMPLE LOCATION]
    END
  ELSE
    [SAMPLE LOCATION]
  END AS LOCATION,
  [SAMPLE RECORDERS],
  SAMPLE_VAGUE_DATE_START,
  SAMPLE_VAGUE_DATE_END,
  NBNData.dbo.LCReturnVagueDateShort(SAMPLE_VAGUE_DATE_START, Sample_Vague_Date_End, Sample_Vague_Date_Type) AS DATE
FROM
  HW_ALL